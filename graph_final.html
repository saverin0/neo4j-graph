<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Neo4j Graph Explorer</title>

  <script src="https://cdn.jsdelivr.net/npm/neovis.js@2.0.2/dist/neovis.js"></script>

  <style>
    html, body, #viz { width: 100%; height: 100%; margin: 0; }
    #topbar{
      position: fixed; top: 10px; left: 10px; z-index: 999;
      background: rgba(255,255,255,0.95); padding: 10px 12px;
      border: 1px solid #ddd; border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      max-width: 560px; font-family: Arial, sans-serif;
    }
    #topbar small { color:#444; }
  </style>
</head>

<body>
  <div id="topbar">
    <b>Graph Explorer</b>
    <small>Landing view: most connected CircularValueChain / Partner / Deliverable nodes.</small>
  </div>

  <div id="viz"></div>

  <script>
    const config = {
      containerId: "viz",

      neo4j: {
        // IMPORTANT: no +s here
        serverUrl: "neo4j://6c04bbfb.databases.neo4j.io",
        serverUser: "neo4j",
        serverPassword: "DIl4t3fCTbVppjzRLVDX05BxScsiVG1-Q8qQGGlFF9U",

        // IMPORTANT: encryption configured ONLY here
        driverConfig: {
          encrypted: "ENCRYPTION_ON",
          trust: "TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"
        }
      },

      // Clean landing view (no DB changes)
      initialCypher: `
  MATCH (n)
  WHERE n:CircularValueChain OR n:Partner OR n:Deliverable
  WITH n, COUNT { (n)--() } AS deg
  ORDER BY deg DESC
  LIMIT 25
  MATCH (n)-[r]-(m)
  RETURN n, r, m
  LIMIT 400
`,


      labels: {
        Partner: { caption: "partners_legalname" },
        Deliverable: { caption: "deliverables_name" },
        Phase: { caption: "phase_id" },
        Demonstration: { caption: "demonstrations" },
        CircularValueChain: { caption: "value_chains" },
        Innovation: { caption: "phase_id" }
      },

      relationships: { "*": {} },

      visConfig: {
        edges: { width: 2, smooth: false },
        physics: { enabled: true, stabilization: { iterations: 300 } }
      }
    };

    const viz = new NeoVis.default(config);
    viz.render();
  </script>
</body>
</html>
